class t{desiredFalsePositiveRate=.1;desiredNumElements=10;desiredNumHashCount=3;desiredSize=10;constructor(t=10,e=3){this.hashCount=e,this.desiredNumHashCount=e,this.desiredSize=t,this.size=t,this.bits=Array(t).fill(!1)}hash(t,e){let i=0;for(let n=0;n<t.length;n++)i=(i*e+t.charCodeAt(n))%this.size;return i}add(t){let e=[];for(let i=1;i<=this.hashCount;i++){let n=this.hash(t,i);this.bits[n]=!0,e.push(n)}return e}contains(t){for(let e=1;e<=this.hashCount;e++){let i=this.hash(t,e);if(!this.bits[i])return!1}return!0}falsePositiveRate(t){return Math.pow(1-Math.exp(-this.hashCount/(this.size/parseFloat(t))),this.hashCount)}calculateOptimalSize(t){return Math.ceil(this.desiredNumElements*Math.log(this.desiredFalsePositiveRate)/Math.log(1/Math.pow(2,Math.log(2))))}calculateOptimalHashCount(t){return Math.round(this.size/t*Math.log(2))}}class e{div1;div2;side;color;constructor(t,e,i=null,n=null){this.div1=t.id,this.div2=e.id,this.side=i,this.color=n}}const i=new class{static svg;itemLines;checkLines;canvasContainer;constructor(){this.canvasContainer=document.getElementById("filter-container"),this.initializeSVG(),this.itemLines=[],this.checkLines=[]}renderLines(){for(let t of(this.canvasContainer.removeChild(this.svg),this.initializeSVG(),this.itemLines))this.#t(t);for(let t of this.checkLines)this.#t(t)}initializeSVG(){this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("id","connection-svg"),this.svg.style.position="absolute",this.svg.style.left="0",this.svg.style.top="0",this.svg.style.width="100%",this.svg.style.height="100%",this.svg.style.pointerEvents="none",this.canvasContainer.appendChild(this.svg)}#t(t){let e,i,n,s,l=document.getElementById(t.div2);"0"===l.innerHTML&&(l.style.backgroundColor="#f76c6cff"),"1"===l.innerHTML&&(l.style.backgroundColor="#4bb543ff");let a=document.getElementById(t.div1).getBoundingClientRect(),o=l.getBoundingClientRect(),h=this.canvasContainer.getBoundingClientRect();"right"===t.side&&(e=a.left-h.left,i=a.top-h.top+a.height/2,n=o.left-h.left+o.width,s=o.top-h.top+o.height/2),"left"===t.side&&(e=a.left+a.width-h.left,i=a.top+a.height/2-h.top,n=o.left-h.left,s=o.top+o.height/2-h.top);let d=document.createElementNS("http://www.w3.org/2000/svg","line"),r=t.color||"#143b83ff";return d.setAttribute("x1",e),d.setAttribute("y1",i),d.setAttribute("x2",n),d.setAttribute("y2",s),d.setAttribute("stroke",r),d.setAttribute("stroke-width","4"),this.svg.appendChild(d),d}drawCheckLine(t,i,n){let s=new e(t,i,"right",n);return this.checkLines.push(s),s}drawItemLine(t,i,n){let s=new e(t,i,"left",n);return this.itemLines.push(s),s}clearCheckLines(){this.checkLines=[]}clearAllLines(){this.itemLines=[],this.checkLines=[]}},n=new t(15,3),s=new class{draw=null;bitsRendered=!1;inputCheckButton=null;inputItemButton=null;inputCheckField=null;inputItemField=null;inputWordDiv=null;captionDiv=null;bitsDiv=null;listDiv=null;bloom=null;currentElements=[];infoDivs=[];constructor(t,e){this.draw=t,this.bitsRendered=!1,this.bloom=e,this.initializeAddItemInputContainer(),this.initializeAddItemContainer(),this.initializeBloomFilterContainer(),this.initializeCheckItemContainer(),this.initializeDisplayContainer(),this.initializeStartingParamsUI(),this.initializeInfoContainer(),this.initializeWithDummyData=!0,this.rebuildUI()}addInfoDiv(t,e,i=""){let n=document.createElement("div");n.className="info-group";let s=document.createElement("label");s.textContent=t+": ",s.className="info-label",n.appendChild(s);let l=document.createElement("span");l.className="info-value",n.appendChild(l),document.addEventListener("refreshUI",()=>{l.textContent=e()+i}),this.infoDivs.push(n),l.textContent=e()}initializeInfoContainer(){this.addInfoDiv("Filter Size",()=>this.bloom.size),this.addInfoDiv("Hash Functions",()=>this.bloom.hashCount),this.addInfoDiv("Elements Added",()=>this.currentElements.length),this.addInfoDiv("False Positive Rate",()=>this.bloom.falsePositiveRate(this.currentElements.length).toFixed(4)," %")}renderInfoContainer(){let t=document.getElementById("info-container");for(let e of(t.innerHTML="",this.infoDivs))t.appendChild(e)}renderBits(){this.bitsDiv.innerHTML="",this.bloom.bits.forEach((t,e)=>{let i=document.createElement("div");i.className="bit-item",i.textContent=t?"1":"0",i.title=`Bit ${e}`,i.id="bit-"+e,this.bitsDiv.appendChild(i)})}checkItem(){this.draw.clearCheckLines();let t=this.inputCheckField.value.trim();if(this.inputCheckField.value="",t){let e=!0;this.inputWordDiv.textContent=t,this.inputWordDiv.style.opacity="1";for(let i=1;i<=this.bloom.hashCount;i++){let n=this.bloom.hash(t,i),s=document.getElementById("bit-"+n),l="#14ce43ff";this.bloom.bits[n]||(e=!1,l="#c93030ff"),s&&this.draw.drawCheckLine(this.inputWordDiv,s,l)}e?(this.captionDiv.textContent=`"${t}" is possibly in the set.`,this.captionAlertDiv.textContent="(true positive)",this.captionAlertDiv.style.color="#14ce43ff",this.currentElements.includes(t)||(this.captionAlertDiv.textContent="(false positive)",this.captionAlertDiv.style.color="#ff7b00ff")):(this.captionDiv.textContent=`"${t}" is definitely not in the set.`,this.captionAlertDiv.textContent="(true negative)",this.captionAlertDiv.style.color="#c93030ff")}else this.inputWordDiv.style.opacity="0",this.captionDiv.textContent="",this.captionAlertDiv.textContent="";document.dispatchEvent(new Event("refreshUI"))}addItem(){let t=this.inputItemField.value.trim();if(t){let e=document.createElement("div");e.className="list-item",e.textContent=t,e.id="item-"+t,this.listDiv.appendChild(e);let i=this.#e(t);this.bloom.add(t),this.currentElements.push(t),this.inputItemField.value="";for(let n=1;n<=this.bloom.hashCount;n++){let s=this.bloom.hash(t,n),l=document.getElementById("bit-"+s);l&&this.draw.drawItemLine(e,l,i)}this.checkItem()}}#e(t){let e=0;for(let i=0;i<t.length;i++)e=t.charCodeAt(i)+((e<<5)-e);let i="#";for(let t=0;t<3;t++)i+=(e>>8*t&255).toString(16).padStart(2,"0");return i}initializeAddItemInputContainer(){let t=document.getElementById("add-item-input-container");this.inputItemField=document.createElement("input"),this.inputItemField.type="text",this.inputItemField.placeholder="Enter item value",this.inputItemField.maxLength=20,this.inputItemField.className="text-input-field",t.appendChild(this.inputItemField),this.inputItemButton=document.createElement("button"),this.inputItemButton.id="add-item-btn",this.inputItemButton.textContent="Add Element",this.inputItemButton.className="input-button",t.appendChild(this.inputItemButton),this.inputItemButton.addEventListener("click",()=>this.addItem()),this.inputItemField.addEventListener("keydown",t=>{"Enter"===t.key&&this.addItem()})}initializeAddItemContainer(){let t=document.getElementById("add-item-container");t.innerHTML="",this.listDiv=document.createElement("div"),this.listDiv.id="left-list",this.listDiv.className="list-elements",t.appendChild(this.listDiv)}initializeBloomFilterContainer(){let t=document.getElementById("bloom-filter-container");t.innerHTML="",this.bitsDiv=document.createElement("div"),this.bitsDiv.className="bloom-filter-elements",t.appendChild(this.bitsDiv),this.renderBits()}initializeCheckItemContainer(){let t=document.getElementById("check-item-input-container");t.innerHTML="",this.inputCheckField=document.createElement("input"),this.inputCheckField.type="text",this.inputCheckField.placeholder="Enter item to check",this.inputCheckField.maxLength=20,this.inputCheckField.className="text-input-field",t.appendChild(this.inputCheckField),this.inputCheckButton=document.createElement("button"),this.inputCheckButton.textContent="Check Item",this.inputCheckButton.className="input-button",t.appendChild(this.inputCheckButton),this.inputCheckButton.addEventListener("click",()=>this.checkItem()),this.inputCheckField.addEventListener("keydown",t=>{"Enter"===t.key&&this.checkItem()})}initializeDisplayContainer(){this.displayContainer=document.getElementById("check-item-container"),this.displayContainer.innerHTML="",this.inputWordDiv=document.createElement("div"),this.inputWordDiv.id="right-list",this.inputWordDiv.className="list-item",this.displayContainer.appendChild(this.inputWordDiv),this.inputWordDiv.style.opacity="0",this.captionDiv=document.createElement("div"),this.captionDiv.id="caption",this.captionDiv.className="caption",this.displayContainer.appendChild(this.captionDiv),this.captionAlertDiv=document.createElement("div"),this.captionAlertDiv.id="caption-alert",this.captionAlertDiv.className="caption",this.displayContainer.appendChild(this.captionAlertDiv)}initializeStartingParamsUI(){let t=document.getElementById("starting-params-container");t.innerHTML="";let e=document.createElement("div");e.className="input-group";let i=document.createElement("label");i.textContent="Bloom filter size:",i.setAttribute("for","bloom-size-input"),i.className="input-label",e.appendChild(i);let n=document.createElement("input");n.className="input-field",n.type="number",n.value=this.bloom.size,e.appendChild(n),t.appendChild(e),(e=document.createElement("div")).className="input-group";let s=document.createElement("label");s.textContent="Number of hash functions:",s.setAttribute("for","bloom-hashcount-input"),s.className="input-label",e.appendChild(s);let l=document.createElement("input");l.type="number",l.placeholder="Number of hash functions",l.className="input-field",l.value=this.bloom.hashCount,l.id="bloom-hashcount-input",e.appendChild(l),t.appendChild(e),(e=document.createElement("div")).className="input-group";let a=document.createElement("label");a.textContent="Enable dummy data:",a.setAttribute("for","dummy-data-checkbox"),a.className="input-label",e.appendChild(a);let o=document.createElement("input");o.type="checkbox",o.id="dummy-data-checkbox",o.className="input-checkbox",o.checked=!0,this.initializeWithDummyData=!0,e.appendChild(o),t.appendChild(e),(e=document.createElement("div")).className="input-group";let h=document.createElement("button");h.textContent="Set Parameters",h.className="input-button",e.appendChild(h),t.appendChild(e),o.addEventListener("change",()=>{o.checked?this.initializeWithDummyData=!0:this.initializeWithDummyData=!1}),n.addEventListener("change",()=>{let t=parseInt(n.value);!isNaN(t)&&t>0&&(this.bloom.desiredSize=t)}),l.addEventListener("change",()=>{let t=parseInt(l.value);!isNaN(t)&&t>0&&(this.bloom.desiredNumHashCount=t)}),h.addEventListener("click",()=>this.rebuildUI())}rebuildUI(){this.currentElements=[],this.draw.clearAllLines(),this.listDiv.innerHTML="",this.inputCheckField.value="",(this.bloom.desiredSize!=this.bloom.size||this.bloom.desiredNumHashCount!=this.bloom.hashCount)&&(this.bloom=new t(this.bloom.desiredSize,this.bloom.desiredNumHashCount)),this.initializeWithDummyData&&(["apple","banana","grape","orange"].forEach(t=>{this.inputItemField.value=t,this.addItem()}),this.inputCheckField.value="test"),this.checkItem()}}(i,n);function l(){s.renderBits(),s.renderInfoContainer(),i.renderLines()}document.addEventListener("refreshUI",()=>{l()}),document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{l()},50)}),window.addEventListener("resize",()=>{document.dispatchEvent(new Event("refreshUI"))}),window.addEventListener("scroll",()=>{document.dispatchEvent(new Event("refreshUI"))});
//# sourceMappingURL=bloom_filter_va.daee170b.js.map
